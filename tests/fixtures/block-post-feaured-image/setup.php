<?php
/**
 * Setup for the post featured image block.
 * 
 * @var string $post_content The post content.
 * @var BlockeraTest $this The test instance.
 * @var string $designName The design name.
 */
	
$post_id = $this->factory()->post->create([
	'post_title'   => 'Test Design: ' . $designName,
	'post_content' => $post_content,
	'post_status'  => 'publish',
	'post_type'    => blockera_test_get_post_type($designName),
]);

// Base64 encoded 600x400 placeholder image
$base64_image = 'iVBORw0KGgoAAAANSUhEUgAAAlgAAAGQCAYAAAByNR6YAAAACXBIWXMAAAsTAAALEwEAmpwYAAAcZUlEQVR4nO3d53ojx7UFUL//G9hyTnJO8tiWHGQ5aWRLTnKWzrPwfpu6vB7xgpzTjdNogFg/1qcwJNHENKp3VZ2q+kRV3QAAUGM+sfcFAADUEyNgAQDULAELAKBmCVgAADVLwAIAqFkCFgBAzRKwAABqloAFAFCzBCwAgJolYAEA1CwBCwCgZglYAAA1S8ACAKhZAhYAQM0SsAAAapaABQBQswQsAICaJWABANQsAQsAoGYJWAAANUvAAgCoWQIWAEDNErAAAGqWgAUAULMELACAmiVgAQDULAELAKBmCVgAADVLwAIAqFkCFgBAzRKwAABqloAFAFCzBCwAgJolYAEA1CwBCwCgZglYAAA1S8ACAKhZAhYAQM0SsAAAapaABQBQswQsAICaJWABANQsAQsAoGYJWAAANUvAAgCoWQIWAEDNErAAAGqWgAUAULMELACAmiVgAQDULAELAKBmCVgAADVLwAIAqFkCFgBAzRKwAABqloAFAFCzBCwAgJolYAEA1CwBCwCgZglYAAA1S8ACAKhZAhYAQM0SsAAAapaABQBQswQsAICaJWABANQsAQsAoGYJWAAANUvAAgCoWQIWAEDNErAAAGqWgAUAULMELACAmiVgAQDULAELAKBmCVgAADVLwAIAqFkCFgBAzRKwAABqloAFAFCzBCwAgJolYAEA1CwBCwCgZglYAAA1S8ACAKhZAhYAQM0SsAAAapaABQBQswQsAICaJWABANQsAQsAoGYJWAAANUvAAgCoWQIWAEDNErAAAGqWgAUAULMELACAmiVgAQDULAELAKBmCVgAADVLwAIAqFkCFgBAzRKwAABqloAFAFCzBCwAgJolYAEA1CwBCwCgZglYAAA1S8ACAKhZAhYAQM0SsAAAapaABQBQswQsAICaJWABANQsAQsAoGYJWAAANUvAAgCoWQIWAEDNErAAAGqWgAUAULMELACAmiVgAQDULAELAKBmCVgAADVLwAIAqFkCFgBAzRKwAABqloAFAFCzBCwAgJolYAEA1CwBCwCgZglYAAA1S8ACAKhZAhYAQM0SsAAAapaABQBQswQsAICaJWABANQsAQsAoGYJWAAANUvAAgCoWQIWAEDNErAAAGqWgAUAULMELACAmiVgAQDULAELAKBmCVgAADVLwAIAqFkCFgBAzRKwAABqloAFAFCzBCwAgJolYAEA1CwBCwCgZglYAAA1S8ACAKhZAhYAQM0SsAAAapaABQBQswQsAICaJWABANQsAQsAoGYJWAAANUvAAgCoWQIWAEDNErAAAGqWgAUAULMELACAmiVg8ST961//unn33XdvfvWrX9387Gc/u3n99ddv5d/z//Jn+Zq9r/O+Dz/88ObPf/7zze9+97ubX/ziFzdvvPHG7XXnn/nv58+f3/z1r3/d/TrhZffxX/7ylwfv47fffvv2Ps7X7X2t9/3jH/+4+f3vf3/zy1//8mNtx89//vPbtuO99967+fe//737dVJnT8BitQSBH/3oRzdf/epXbz7/+c/ffPazn31Q/jwN7pbX87e//e22Ac/1fPKTn2zJ1+Z73n///d3ex//85z83v/nNb26+/e1v33z6059uXffnPve5m+9///s377zzzlk+pDid3AePffbu5D7b8jpyHyZQffe73735zGc+07qPc13f+973br9vz/s4bdOPf/zjmy9//cut6/7Upz5187Wvfe02gCWQ7X0PUGdJwGKxNIQJVmlkukEmAWLLoJdw0r2Wh3zrW9+6+eMf/3iy9zEPvIS77sPoIQmv6W0LWtfnrbfeat8nWwWs/NyMSiX0H3Mf5/vzc7YOgi/KSPbXv/71o6477WBCopFl6h4Bi8Vee+21RQ3QT37yk02uIw3xD3/4w0VBr+MHP/jB5lMAmeo79oF03xe/+MXb6Yu97w9OIx2LV155ZdeA9Yc//OHmC1/4wuh9nA5Dpui2fO9SHpCRtsnrTjuUtu6DDz7Y/d6gzoKAxSK//vWvF48KbTGykt5idzh/bVjJA2z6uvNePHv2bLPrTiOfaYu97xO2lQ7Al770pUX3xnTAyujrdOfmRQkrW7QdGaVOiNvqur/yla/clivsfY9QuxOwWBRqujVCkQC0xUjQn/70p9vaja0ayDuZussUwtR15wH3ne98Z/PrjozsmTJ8ujIltfSemApYua8yynuK+zi/5+R9nJrFJW3YWqeoOaXOnoBFS4a9lxSPJ5xsUZOQn3mKcHUnjfFEXVYeEtNTEp2Qtfd9w751V1sErC1HYLcMWZk+XzKleqy0U3sunqF2J2AxXneVaYMtaihSN5Gpu1M2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5GtHzIdP1VbSj05AhYPSoOX0aE0mulZphFPXUSkYclGntmb5hwbmEwBJOzlGrM78/3rzp+d4/Lph97zjHTlvzO1mPqzva8TXnYfJ7Tcv4/zz/x3AlVGfM6xc5D2LO1aOpr3245sXJtp+D2PnaIuhoAFAFCzBCwAgGECFgBAzRKwAABqloAFAFCzBCwAgJolYAEA1CwBCwCgZglYAAA1S8ACAKhZAhYAQM0SsAAAapaABQBQswQsAICaJWABANQsAQsAoGYJWAAANUvAAgCoWQIWAEDNErAAAGqWgAUAULMELACAmiVgAQDULAELAKBmCVgAADVLwAIAqFkCFgBAzRKwAABqloAFAFCzBCwAgJolYAEA1CwBCwCgZglYAAA1S8ACAKhZAhYAQM0SsAAAapaABQBQswQsAICaJWABANQsAQsAoGYJWAAANUvAAgCoWQIWAEDNErAAAGqWgAUAULMELACAmiVgAQDULAELAKBmCVgAADVLwAIAqFkCFgBAzRKwAABqloAFAFCzBCwAgJolYAEA1CwBCwCgZglYAAA1S8ACAKhZAhYAQM0SsAAAapaABQBQswQsAICaJWABANQsAQsAoGYJWAAANUvAAgCoWQIWAEDNErAAAGqWgAUAULMELACAmiVgAQDULAELAKBmCVgAADVLwAIAqFkCFgBAzRKwAABqloAFAFCzBCwAgJolYAEA1CwBCwCgZglYAAA1S8ACAKhZAhYAQM0SsAAAapaABQBQswQsAICaJWABANQsAQsAoGYJWAAANUvAAgCoWQIWAEDNErAAAGqWgAUAULMELACAmiVgAQDULAELAKBmCVgAADVLwAIAqFkCFgBAzRKwAABqloAFAFCzBCwAgJolYAEA1CwBCwCgZglYAAA1S8ACAKhZAhYAQM0SsAAAapaABQBQswQsAICaJWABANQsAQsAoGYJWAAANUvAAgCoWQIWAEDNErAAAGqWgAUAULMELACAmiVgAQDULAELAKBmCVgAADVLwAIAqFkCFgBAzRKwAABqloAFAFCzBCwAgJolYAEA1CwBCwCgZglYAAA1S8ACAKhZAhYAQM0SsAAAapaABQBQswQsAICaJWABANQsAQsAoGYJWAAANUvAAgCoWQIWAEDNErAAAGqWgAUAULMELACAmiVgAQDULAELAKBmCVgAADVLwAIAqFkCFgBAzRKwAABqloAFAFCzBCwAgJolYAEA1CwBCwCgZglYAAA1S8ACAKhZAhYAQM0SsAAAapaABQBQswQsAICaJWABANQsAQsAoGYJWAAANUvAAgCoWQIWAEDNErAAAGqWgAUAULMELACAmiVgAQDULAELAKBmCVgAADVLwAIAqFn/A3f9FddiDOpyAAAAAElFTkSuQmCC';

// Decode base64 image data
$image_data = base64_decode($base64_image);

// Get upload directory and create unique filename
$filename = 'featured-image.png';

// Save image using wp_upload_bits (handles file operations properly)
$upload = wp_upload_bits($filename, null, $image_data);

if (!$upload['error']) {
	// Prepare attachment data
	$attachment = array(
		'post_mime_type' => 'image/png',
		'post_title'     => sanitize_file_name(pathinfo($filename, PATHINFO_FILENAME)),
		'post_content'   => '',
		'post_status'    => 'inherit',
		'post_parent'    => $post_id,
	);

	// Insert attachment
	require_once(ABSPATH . 'wp-admin/includes/image.php');
	$attachment_id = wp_insert_attachment($attachment, $upload['file'], $post_id);

	if (!is_wp_error($attachment_id)) {
		// Generate attachment metadata (may not work for SVG, but safe to call)
		$attachment_data = wp_generate_attachment_metadata($attachment_id, $upload['file']);
		if (!empty($attachment_data)) {
			wp_update_attachment_metadata($attachment_id, $attachment_data);
		}

		// Set as featured image
		set_post_thumbnail($post_id, $attachment_id);
	}
}

