// @flow

/**
 * External dependencies.
 */
import { __, sprintf } from '@wordpress/i18n';
import { applyFilters } from '@wordpress/hooks';
import { createRoot } from '@wordpress/element';

const App = () => {
	const {
		blockeraPluginName,
		blockeraPluginUpdateUrl,
		blockeraPluginRequiredName,
		blockeraPluginRequiredVersion,
		blockeraPluginRequiredPluginSlug,
		blockeraIsActiveCompatiblePlugin,
		blockeraPluginRequiredPluginVersion,
	} = window;

	const hasDirectUpdateURL = applyFilters(
		'blockera.compatibility.directUpdateRequiredPlugin',
		blockeraIsActiveCompatiblePlugin,
		blockeraPluginUpdateUrl
	);

	const requiredPluginType = blockeraPluginRequiredPluginSlug.endsWith('-pro')
		? 'pro'
		: 'free';

	return (
		<div className="blockera-compatibility-notice">
			<div className="blockera-compatibility-notice-header">
				<svg
					width="99"
					height="21"
					viewBox="0 0 99 21"
					fill="none"
					xmlns="http://www.w3.org/2000/svg"
				>
					<path
						d="M31.3942 16.5V4.86364H36.0533C36.9093 4.86364 37.6233 4.99053 38.1953 5.24432C38.7673 5.49811 39.1972 5.85038 39.4851 6.30114C39.773 6.74811 39.9169 7.26326 39.9169 7.84659C39.9169 8.30114 39.826 8.70076 39.6442 9.04545C39.4624 9.38636 39.2124 9.66667 38.8942 9.88636C38.5798 10.1023 38.2199 10.2557 37.8146 10.3466V10.4602C38.2578 10.4792 38.6726 10.6042 39.0589 10.8352C39.4491 11.0663 39.7654 11.3902 40.0078 11.8068C40.2502 12.2197 40.3714 12.7121 40.3714 13.2841C40.3714 13.9015 40.218 14.4527 39.9112 14.9375C39.6082 15.4186 39.1593 15.7992 38.5646 16.0795C37.9699 16.3598 37.237 16.5 36.3658 16.5H31.3942ZM33.8544 14.4886H35.8601C36.5457 14.4886 37.0457 14.358 37.3601 14.0966C37.6745 13.8314 37.8317 13.4792 37.8317 13.0398C37.8317 12.7178 37.754 12.4337 37.5987 12.1875C37.4434 11.9413 37.2218 11.7481 36.9339 11.608C36.6499 11.4678 36.3108 11.3977 35.9169 11.3977H33.8544V14.4886ZM33.8544 9.73295H35.6783C36.0154 9.73295 36.3146 9.67424 36.576 9.55682C36.8411 9.43561 37.0495 9.26515 37.201 9.04545C37.3563 8.82576 37.4339 8.5625 37.4339 8.25568C37.4339 7.83523 37.2843 7.49621 36.9851 7.23864C36.6896 6.98106 36.2692 6.85227 35.7237 6.85227H33.8544V9.73295ZM44.3473 4.86364V16.5H41.9268V4.86364H44.3473ZM50.2294 16.6705C49.3468 16.6705 48.5836 16.483 47.9396 16.108C47.2995 15.7292 46.8052 15.2027 46.4567 14.5284C46.1082 13.8504 45.9339 13.0644 45.9339 12.1705C45.9339 11.2689 46.1082 10.4811 46.4567 9.80682C46.8052 9.12879 47.2995 8.60227 47.9396 8.22727C48.5836 7.84848 49.3468 7.65909 50.2294 7.65909C51.112 7.65909 51.8733 7.84848 52.5135 8.22727C53.1574 8.60227 53.6536 9.12879 54.0021 9.80682C54.3506 10.4811 54.5249 11.2689 54.5249 12.1705C54.5249 13.0644 54.3506 13.8504 54.0021 14.5284C53.6536 15.2027 53.1574 15.7292 52.5135 16.108C51.8733 16.483 51.112 16.6705 50.2294 16.6705ZM50.2408 14.7955C50.6423 14.7955 50.9775 14.6818 51.2464 14.4545C51.5154 14.2235 51.718 13.9091 51.8544 13.5114C51.9946 13.1136 52.0646 12.661 52.0646 12.1534C52.0646 11.6458 51.9946 11.1932 51.8544 10.7955C51.718 10.3977 51.5154 10.0833 51.2464 9.85227C50.9775 9.62121 50.6423 9.50568 50.2408 9.50568C49.8355 9.50568 49.4946 9.62121 49.218 9.85227C48.9453 10.0833 48.7389 10.3977 48.5987 10.7955C48.4624 11.1932 48.3942 11.6458 48.3942 12.1534C48.3942 12.661 48.4624 13.1136 48.5987 13.5114C48.7389 13.9091 48.9453 14.2235 49.218 14.4545C49.4946 14.6818 49.8355 14.7955 50.2408 14.7955ZM60.0419 16.6705C59.148 16.6705 58.379 16.4811 57.7351 16.1023C57.0949 15.7197 56.6025 15.1894 56.2578 14.5114C55.9169 13.8333 55.7464 13.053 55.7464 12.1705C55.7464 11.2765 55.9188 10.4924 56.2635 9.81818C56.612 9.14015 57.1063 8.61174 57.7464 8.23295C58.3866 7.85038 59.148 7.65909 60.0305 7.65909C60.7919 7.65909 61.4586 7.79735 62.0305 8.07386C62.6025 8.35038 63.0552 8.73864 63.3885 9.23864C63.7218 9.73864 63.9055 10.3258 63.9396 11H61.6555C61.5911 10.5644 61.4207 10.214 61.1442 9.94886C60.8714 9.67992 60.5135 9.54545 60.0703 9.54545C59.6953 9.54545 59.3677 9.64773 59.0874 9.85227C58.8108 10.053 58.5949 10.3466 58.4396 10.733C58.2843 11.1193 58.2067 11.5871 58.2067 12.1364C58.2067 12.6932 58.2824 13.1667 58.4339 13.5568C58.5893 13.947 58.8071 14.2443 59.0874 14.4489C59.3677 14.6534 59.6953 14.7557 60.0703 14.7557C60.3468 14.7557 60.5949 14.6989 60.8146 14.5852C61.0381 14.4716 61.2218 14.3068 61.3658 14.0909C61.5135 13.8712 61.6101 13.608 61.6555 13.3011H63.9396C63.9018 13.9678 63.7199 14.5549 63.3942 15.0625C63.0722 15.5663 62.6271 15.9602 62.0589 16.2443C61.4908 16.5284 60.8184 16.6705 60.0419 16.6705ZM67.6825 13.9886L67.6882 11.0852H68.0405L70.8359 7.77273H73.6143L69.8587 12.1591H69.2848L67.6825 13.9886ZM65.4893 16.5V4.86364H67.9098V16.5H65.4893ZM70.9439 16.5L68.3757 12.6989L69.9893 10.9886L73.7791 16.5H70.9439ZM78.4197 16.6705C77.522 16.6705 76.7493 16.4886 76.1016 16.125C75.4576 15.7576 74.9614 15.2386 74.6129 14.5682C74.2644 13.8939 74.0902 13.0966 74.0902 12.1761C74.0902 11.2784 74.2644 10.4905 74.6129 9.8125C74.9614 9.13447 75.4519 8.60606 76.0845 8.22727C76.7209 7.84848 77.4671 7.65909 78.3232 7.65909C78.8989 7.65909 79.4349 7.75189 79.9311 7.9375C80.4311 8.11932 80.8667 8.39394 81.2379 8.76136C81.6129 9.12879 81.9046 9.59091 82.1129 10.1477C82.3213 10.7008 82.4254 11.3485 82.4254 12.0909V12.7557H75.0561V11.2557H80.147C80.147 10.9072 80.0713 10.5985 79.9197 10.3295C79.7682 10.0606 79.558 9.85038 79.2891 9.69886C79.0239 9.54356 78.7152 9.46591 78.3629 9.46591C77.9955 9.46591 77.6697 9.55114 77.3857 9.72159C77.1054 9.88826 76.8857 10.1136 76.7266 10.3977C76.5675 10.678 76.486 10.9905 76.4822 11.3352V12.7614C76.4822 13.1932 76.5618 13.5663 76.7209 13.8807C76.8838 14.1951 77.1129 14.4375 77.4084 14.608C77.7038 14.7784 78.0542 14.8636 78.4595 14.8636C78.7285 14.8636 78.9747 14.8258 79.1982 14.75C79.4216 14.6742 79.6129 14.5606 79.772 14.4091C79.9311 14.2576 80.0523 14.072 80.1357 13.8523L82.3743 14C82.2607 14.5379 82.0277 15.0076 81.6754 15.4091C81.3269 15.8068 80.8762 16.1174 80.3232 16.3409C79.7739 16.5606 79.1394 16.6705 78.4197 16.6705ZM84.005 16.5V7.77273H86.3516V9.29545H86.4425C86.6016 8.75379 86.8686 8.3447 87.2436 8.06818C87.6186 7.78788 88.0504 7.64773 88.5391 7.64773C88.6603 7.64773 88.791 7.6553 88.9311 7.67045C89.0713 7.68561 89.1944 7.70644 89.3004 7.73295V9.88068C89.1868 9.84659 89.0296 9.81629 88.8288 9.78977C88.6281 9.76326 88.4444 9.75 88.2777 9.75C87.9216 9.75 87.6035 9.82765 87.3232 9.98295C87.0466 10.1345 86.8269 10.3466 86.6641 10.6193C86.505 10.892 86.4254 11.2064 86.4254 11.5625V16.5H84.005ZM92.7905 16.6648C92.2337 16.6648 91.7375 16.5682 91.3018 16.375C90.8662 16.178 90.5215 15.8883 90.2678 15.5057C90.0178 15.1193 89.8928 14.6383 89.8928 14.0625C89.8928 13.5777 89.9818 13.1705 90.1598 12.8409C90.3378 12.5114 90.5803 12.2462 90.8871 12.0455C91.1939 11.8447 91.5424 11.6932 91.9325 11.5909C92.3265 11.4886 92.7393 11.4167 93.1712 11.375C93.6787 11.322 94.0878 11.2727 94.3984 11.2273C94.709 11.178 94.9344 11.1061 95.0746 11.0114C95.2147 10.9167 95.2848 10.7765 95.2848 10.5909V10.5568C95.2848 10.197 95.1712 9.91856 94.9439 9.72159C94.7204 9.52462 94.4022 9.42614 93.9893 9.42614C93.5537 9.42614 93.2071 9.52273 92.9496 9.71591C92.692 9.9053 92.5215 10.1439 92.4382 10.4318L90.1996 10.25C90.3132 9.7197 90.5367 9.26136 90.87 8.875C91.2034 8.48485 91.6333 8.18561 92.1598 7.97727C92.6901 7.76515 93.3037 7.65909 94.0007 7.65909C94.4856 7.65909 94.9496 7.71591 95.3928 7.82955C95.8397 7.94318 96.2356 8.11932 96.5803 8.35795C96.9287 8.59659 97.2034 8.90341 97.4041 9.27841C97.6049 9.64962 97.7053 10.0947 97.7053 10.6136V16.5H95.4098V15.2898H95.3416C95.2015 15.5625 95.014 15.803 94.7791 16.0114C94.5443 16.2159 94.2621 16.3769 93.9325 16.4943C93.603 16.608 93.2223 16.6648 92.7905 16.6648ZM93.4837 14.9943C93.8397 14.9943 94.1541 14.9242 94.4268 14.7841C94.6996 14.6402 94.9136 14.447 95.0689 14.2045C95.2242 13.9621 95.3018 13.6875 95.3018 13.3807V12.4545C95.2261 12.5038 95.1219 12.5492 94.9893 12.5909C94.8606 12.6288 94.7147 12.6648 94.5518 12.6989C94.389 12.7292 94.2261 12.7576 94.0632 12.7841C93.9003 12.8068 93.7526 12.8277 93.62 12.8466C93.3359 12.8883 93.0878 12.9545 92.8757 13.0455C92.6636 13.1364 92.4988 13.2595 92.3814 13.4148C92.264 13.5663 92.2053 13.7557 92.2053 13.983C92.2053 14.3125 92.3246 14.5644 92.5632 14.7386C92.8056 14.9091 93.1125 14.9943 93.4837 14.9943Z"
						fill="#0051E7"
					/>
					<path
						d="M18.7988 15.4979L10.7646 20.1366V11.3368L18.7988 6.69809V15.4979ZM8.85156 11.1102C9.08808 11.2468 9.23333 11.499 9.2334 11.7723V14.4432C9.23306 14.5901 9.0745 14.6814 8.94727 14.6083L8.22949 14.1942C8.1656 14.1575 8.08594 14.2037 8.08594 14.2772V16.1864C8.08597 16.3229 8.15917 16.449 8.27734 16.5174L9.04297 16.9598C9.16092 17.0284 9.23339 17.1545 9.2334 17.2909V19.7997C9.23339 19.9468 9.07459 20.0386 8.94727 19.9657L1.19922 15.492V6.69224L8.85156 11.1102ZM3.1123 14.6834L6.41211 16.5887C6.47588 16.6252 6.55543 16.5789 6.55566 16.5057V15.3612C6.55559 15.2247 6.4824 15.0986 6.36426 15.0301L3.1123 13.1522V14.6834ZM3.1123 11.6219L6.41211 13.5272C6.47601 13.5639 6.55566 13.5176 6.55566 13.4442V12.3006C6.55566 12.1641 6.48237 12.0381 6.36426 11.9696L3.1123 10.0916V11.6219ZM17.9512 5.65708L9.99902 10.2489L2.04688 5.65708L9.99902 1.06626L17.9512 5.65708Z"
						fill="#0051E7"
					/>
				</svg>

				<a
					href="https://community.blockera.ai/changelog-9l8hbrv0"
					target="_blank"
					rel="noreferrer"
					style={{
						display: 'flex',
						alignItems: 'center',
						gap: '5px',
						textDecoration: 'none',
					}}
				>
					<svg
						width="12"
						height="13"
						viewBox="0 0 12 13"
						fill="currentColor"
						xmlns="http://www.w3.org/2000/svg"
					>
						<path
							fillRule="evenodd"
							clipRule="evenodd"
							d="M0.640658 0.49384C0.994483 0.49384 1.28131 0.780672 1.28131 1.1345V3.48357L7.23124 3.48357C7.51227 2.45398 8.4542 1.69713 9.5729 1.69713C10.9133 1.69713 12 2.78378 12 4.12423C12 5.46468 10.9133 6.55133 9.5729 6.55133C8.4542 6.55133 7.51227 5.79448 7.23124 4.76489L1.28131 4.76489V7.22074C1.28131 7.73156 1.28181 8.07615 1.30353 8.3419C1.32463 8.60018 1.36253 8.72708 1.4062 8.81279C1.51605 9.02838 1.69133 9.20366 1.90693 9.31351C1.99263 9.35718 2.11953 9.39508 2.37781 9.41619C2.64356 9.4379 2.98815 9.4384 3.49897 9.4384H7.23124C7.51227 8.40881 8.4542 7.65195 9.5729 7.65195C10.9133 7.65195 12 8.7386 12 10.0791C12 11.4195 10.9133 12.5062 9.5729 12.5062C8.4542 12.5062 7.51227 11.7493 7.23124 10.7197H3.47278C2.9948 10.7197 2.5976 10.7197 2.27347 10.6932C1.93596 10.6657 1.62166 10.6062 1.32522 10.4552C0.868533 10.2225 0.497234 9.85118 0.264539 9.39449C0.113496 9.09805 0.054043 8.78376 0.0264672 8.44624C-1.56622e-05 8.12211 -8.42556e-06 7.7249 3.16125e-07 7.24692L5.98115e-07 1.1345C5.98115e-07 0.780672 0.286833 0.49384 0.640658 0.49384ZM9.5729 2.97844C8.94009 2.97844 8.4271 3.49143 8.4271 4.12423C8.4271 4.75703 8.94009 5.27002 9.5729 5.27002C10.2057 5.27002 10.7187 4.75703 10.7187 4.12423C10.7187 3.49143 10.2057 2.97844 9.5729 2.97844ZM9.5729 8.93327C8.94009 8.93327 8.4271 9.44625 8.4271 10.0791C8.4271 10.7119 8.94009 11.2248 9.5729 11.2248C10.2057 11.2248 10.7187 10.7119 10.7187 10.0791C10.7187 9.44625 10.2057 8.93327 9.5729 8.93327Z"
						/>
					</svg>

					{__('Changelog', 'blockera')}
				</a>
			</div>

			<div className="wrap">
				<div
					style={{
						display: 'flex',
						justifyContent: 'center',
						alignItems: 'center',
						flexDirection: 'column',
						gap: '20px',
					}}
				>
					<svg
						width="60"
						height="60"
						viewBox="0 0 60 60"
						fill="#B80000"
						xmlns="http://www.w3.org/2000/svg"
					>
						<path d="M30.0018 6.56604C31.4371 6.56604 32.7553 7.35694 33.4387 8.61651L54.5293 47.6731C55.1835 48.8839 55.1542 50.3485 54.4512 51.5299C53.7482 52.7114 52.4691 53.434 51.0923 53.434H8.9112C7.53445 53.434 6.26511 52.7114 5.55233 51.5299C4.83955 50.3485 4.82002 48.8839 5.47422 47.6731L26.5648 8.61651C27.2483 7.35694 28.5664 6.56604 30.0018 6.56604ZM30.0018 22.9698C28.7031 22.9698 27.6584 24.0146 27.6584 25.3132V36.2491C27.6584 37.5477 28.7031 38.5925 30.0018 38.5925C31.3004 38.5925 32.3452 37.5477 32.3452 36.2491V25.3132C32.3452 24.0146 31.3004 22.9698 30.0018 22.9698ZM32.6088 44.0604C32.6306 43.7052 32.5794 43.3494 32.4585 43.0148C32.3375 42.6802 32.1494 42.3739 31.9056 42.1147C31.6619 41.8556 31.3676 41.649 31.041 41.5079C30.7145 41.3667 30.3624 41.2939 30.0066 41.2939C29.6509 41.2939 29.2988 41.3667 28.9722 41.5079C28.6457 41.649 28.3514 41.8556 28.1077 42.1147C27.8639 42.3739 27.6757 42.6802 27.5548 43.0148C27.4339 43.3494 27.3827 43.7052 27.4045 44.0604C27.3827 44.4155 27.4339 44.7713 27.5548 45.1059C27.6757 45.4405 27.8639 45.7469 28.1077 46.006C28.3514 46.2652 28.6457 46.4717 28.9722 46.6129C29.2988 46.754 29.6509 46.8269 30.0066 46.8269C30.3624 46.8269 30.7145 46.754 31.041 46.6129C31.3676 46.4717 31.6619 46.2652 31.9056 46.006C32.1494 45.7469 32.3375 45.4405 32.4585 45.1059C32.5794 44.7713 32.6306 44.4155 32.6088 44.0604Z" />
					</svg>

					<h1>
						{sprintf(
							// translators: it's the product name (a theme or plugin name)
							__('Update Required for %s', 'blockera'),
							blockeraPluginRequiredName
						)}
					</h1>

					<div
						style={{
							display: 'flex',
							justifyContent: 'center',
							alignItems: 'center',
							flexDirection: 'column',
							gap: '5px',
						}}
					>
						<p>
							{sprintf(
								// translators: it's the product name (a theme or plugin name)
								__(
									'Your %s plugin is out of date and has been temporarily deactivated.',
									'blockera'
								),
								blockeraPluginRequiredPluginSlug
							)}
						</p>
						<p>
							{sprintf(
								// translators: it's the product name (a theme or plugin name)
								__(
									'Your %1$s version is older than the %2$s version you just installed.',
									'blockera'
								),
								requiredPluginType === 'pro'
									? __('Pro', 'blockera')
									: __('Free', 'blockera'),
								requiredPluginType === 'pro'
									? __('Free', 'blockera')
									: __('Pro', 'blockera')
							)}
						</p>
					</div>
				</div>

				<ul>
					<li>
						<svg
							width="25"
							height="24"
							viewBox="0 0 25 24"
							fill="#008F0A"
							xmlns="http://www.w3.org/2000/svg"
						>
							<path d="M12.25 4C16.6683 4 20.25 7.58172 20.25 12C20.25 16.4183 16.6683 20 12.25 20C7.83172 20 4.25 16.4183 4.25 12C4.25 7.58172 7.83172 4 12.25 4ZM15.9746 9.57324C15.6072 9.25295 15.0111 9.25313 14.6436 9.57324L11.0732 12.6855L9.85645 11.625C9.48888 11.3047 8.89291 11.3046 8.52539 11.625C8.1581 11.9454 8.15814 12.4648 8.52539 12.7852L10.4082 14.4268C10.5846 14.5804 10.8239 14.6669 11.0732 14.667C11.3228 14.667 11.5628 14.5806 11.7393 14.4268L15.9746 10.7344C16.3422 10.4139 16.3422 9.89367 15.9746 9.57324Z" />
						</svg>

						{sprintf(
							// translators: it's the product type (Free or Pro)
							__('Required %s Version:', 'blockera'),
							requiredPluginType === 'pro'
								? __('Pro', 'blockera')
								: __('Free', 'blockera')
						)}

						<strong style={{ color: '#008F0A' }}>
							v{blockeraPluginRequiredVersion}
						</strong>
					</li>

					<li>
						<svg
							width="25"
							height="24"
							viewBox="0 0 25 24"
							fill="#B80000"
							xmlns="http://www.w3.org/2000/svg"
						>
							<path d="M12.75 4C17.1683 4 20.75 7.58172 20.75 12C20.75 16.4183 17.1683 20 12.75 20C8.33172 20 4.75 16.4183 4.75 12C4.75 7.58172 8.33172 4 12.75 4ZM16.0293 8.7207C15.6908 8.38225 15.1422 8.38225 14.8037 8.7207L12.75 10.7744L10.6963 8.7207C10.3578 8.38226 9.80916 8.38227 9.4707 8.7207C9.13225 9.05916 9.13225 9.60783 9.4707 9.94629L11.5244 12L9.4707 14.0537C9.13225 14.3922 9.13225 14.9408 9.4707 15.2793C9.80916 15.6177 10.3578 15.6177 10.6963 15.2793L12.75 13.2256L14.8037 15.2793C15.1422 15.6178 15.6908 15.6178 16.0293 15.2793C16.3677 14.9408 16.3677 14.3922 16.0293 14.0537L13.9756 12L16.0293 9.94629C16.3677 9.60784 16.3677 9.05916 16.0293 8.7207Z" />
						</svg>

						{sprintf(
							// translators: it's the product type (Free or Pro)
							__('Current %s Version:', 'blockera'),
							requiredPluginType === 'pro'
								? __('Pro', 'blockera')
								: __('Free', 'blockera')
						)}

						<strong style={{ color: '#B80000' }}>
							v{blockeraPluginRequiredPluginVersion}
						</strong>
					</li>
				</ul>

				<div
					style={{
						display: 'flex',
						justifyContent: 'center',
						alignItems: 'center',
						flexDirection: 'column',
						gap: '15px',
					}}
				>
					<p
						style={{
							display: 'flex',
							justifyContent: 'center',
							alignItems: 'center',
							flexDirection: 'row',
							gap: '15px',
						}}
					>
						{!blockeraIsActiveCompatiblePlugin && (
							<a
								className="button button-primary"
								href={`${window.location.origin}/wp-admin/update-core.php`}
							>
								{sprintf(
									// translators: it's the plugin name
									__(
										'Install or Update %s Plugin',
										'blockera'
									),
									blockeraPluginName
								)}
							</a>
						)}

						{hasDirectUpdateURL && (
							<a
								className="button button-primary"
								href={blockeraPluginUpdateUrl}
							>
								{__('Update Required Plugin', 'blockera')}
							</a>
						)}

						{!hasDirectUpdateURL && (
							<a
								target="_blank"
								className="button button-primary"
								href={'https://blockera.ai/my-account/licenses'}
								rel="noreferrer"
							>
								{__('Download and Update Manually', 'blockera')}
							</a>
						)}

						<a
							className="button"
							href={`${window.location.origin}/wp-admin/plugins.php?s=${blockeraPluginRequiredPluginSlug}`}
						>
							{__('Manage Plugin', 'blockera')}
						</a>
					</p>

					<p>
						{__(
							'Once updated, Pro features will return instantly.',
							'blockera'
						)}
					</p>
				</div>

				<p style={{ color: '#8A8A8A' }}>
					{__('Need help?', 'blockera')}{' '}
					<a href="https://blockera.ai/contact/">
						{__('Contact support team', 'blockera')}
					</a>
				</p>
			</div>
		</div>
	);
};

createRoot(document.getElementById('root')).render(<App />);
